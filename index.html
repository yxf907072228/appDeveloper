<!DOCTYPE html>
<body>
    <head>
        <meta charset="utf-8" />
        <script src="./socket.io-client/dist/socket.io.dev.js"></script> 
       <!-- <script src="./websocket/lib/WebSocketClient.js"></script> -->
    </head>
    <body>
     <!--    <form action="/upload" enctype="multipart/form-data"  method="post">
            <input type="file" multiple="multiple" name="file1" /><button type="submit">submit</button>
        </form> -->
       <!--  <button type="butotn" onclick="client.emit('message',new Date().toString())">200</button>
        <button type="butotn" onclick="console.log(document.getElementById('f1').contentWindow.document.readyState)">101</button>
        <iframe id="f1" src="http://10.91.7.45:6969/register/123321"></iframe> -->
    </body>    
    <script>
         (function iframelongconnect(){
             var iframe = document.createElement('iframe')
             iframe.setAttribute('src','http://10.91.7.45:3000/event_source')
             iframe.setAttribute('id','f1')
             
             iframe.style.display = 'none'
             iframe.onload=function(e){
                console.log('load!')
             }
             document.body.appendChild(iframe)
             var d1 = document.createElement('div')
             document.body.appendChild(d1)
             setInterval(function(){
                 var str = '',body=null
                 if(iframe.contentWindow){
                    try{
                        body = iframe.contentWindow.document.body
                        str=iframe.contentWindow.document.body.innerText
                    }catch(e){
                      //  console.log(e)
                    }
                 }else{
                     body = iframe.contentDocument.body
                     str = iframe.contentDocument.body.innerText
                 }
      
                 d1.innerHTML = str || 123
                 if(body){
                    body.innerHTML = ''
                 }
                 
             },2000)
         })
/* 
            let ws=new WebSocket('ws://localhost:4000/socket.io/?EIO=3&transport=websocket&sid='+1)
            ws.onopen=(e)=>{
                console.log('open', e)
            }
            ws.onmessage=(e)=>{
                console.log('message', e)
            }
 *//* 
            let chat = new EventSource("/event_source");
            chat.onmessage = function (event) {
                let msg = event.data;
                console.log(msg,'1')
              //  $(".list-group").append("<li class='list-group-item'>" + msg + "</li>");
               //  chat.close(); //关闭server-sent event
            };

            // 自定义事件
            chat.addEventListener("myChatEvent", function (event) {
                let msg = event.data;
                console.log(msg,'2')
                //$(".list-group").append("<li class='list-group-item'>" + msg + "</li>");
            });
 */
       /* const client = io.connect('localhost:3000/')
       client.emit('message','hello')
       client.on('message',()=>{
           console.log(arguments)
       })
     */
      /*  const ws
       fetch('http://localhost:3000/socket.io/?EIO=3&transport=polling&t=MCW3Mq-').then((res)=>{
           return res.text()
       }).then((res)=>{
            let sid = JSON.parse(res.match(/\{.*\}/)[0]).sid

            

            ws=new WebSocket('ws://localhost:3000/socket.io/?EIO=3&transport=websocket&sid='+sid)
            ws.onopen=(e)=>{
                console.log('open', e)

            }
            ws.onmessage=(e)=>{
                console.log('message', e)
            }
       }) */
     /*const ws=new WebSocket('ws://localhost:8080/')
       ws.onopen=(e)=>{
        console.log('open', e)

       }

       ws.onmessage=(e)=>{
        console.log('message', e)
       }

       ws.onclose=(e)=>{
        console.log('close', e)
       } */
/* 
       var client = new WebSocketClient();
       client.on("connect",(connection)=>{
        console.log('connect')
       }) */


    </script>
</body>
<script>
  /*  let template = {
                    "alarm_sample": 1,
                    "alarm_sip": "37.153.119.1",
                    "alarm_sip_host": "37.153.119.1",
                    "alarm_source": 2,
                    "attack_chain": "0x03090000",
                    "attack_host": "66.55.90.2",
                    "attack_ip": "66.55.90.2",
                    "attack_org": "",
                    "attack_phase_name": "\u547d\u4ee4\u63a7\u5236",
                    "attack_phase_sub_name": "\u6df7\u5408\u529f\u80fd\u63a7\u5236",
                    "attack_sip": "66.55.90.17",
                    "attack_type": "\u8fdc\u63a7\u6728\u9a6c"
                   
                }
    let list = []

    for(let i=0;i<4000;i++){
      list.push(
        Object.assign({},template,{
          "alarm_sip": "37.153.119.1"+i,
          "alarm_sip_host": "37.153.119.1"+i,
          "attack_host": "66.55.90.2"+(i+1),
          "attack_ip": "66.55.90.2" + (i+1)
        })
      )
    }

    console.log(JSON.stringify(list,'',2)) */
</script>